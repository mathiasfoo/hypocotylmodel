function dC = proposed_RBLight_ODEmod_com_full(t,C)


%% Modified DeCaluwe's Model (Add Red and Blue Light and LHY inhibit PRR9)

global Ired Iblue

%1st
% v1=6.0517;Aq1=0.1263;Bq3=0.3897;eta1=0.03;Cq4=0.5156;eta2=0.0215;K1=0.1963;K2=1.6099;k1L=0.5517;k1D=0.3927;
% p1=0.8638;p1L=0.2427;d1=0.7718;Aq=0.0145;Bq=1.03506;Cq=2.062453;v2A=2.0729;K3=8.559;K4=0.1947;K5=0.4861;k2=0.3942;
% p2=0.7881;d2D=0.366;d2L=0.2834;v3=1.1465;K6=0.5076;K7=2.3655;k3=0.5821;
% p3=0.6031;d3D=0.5012;d3L=0.5166;v4=2.5024;K8=0.3217;K9=1.7913;K10=1.2238;k4=0.9194;
% p4=1.1243;de1=0.0021;de2=0.4393;de3=0.563;de4=0.5348;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1123;K11=0.3352;k5=0.1588;p5=0.537;d5D=0.448;d5L=5.1786;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

% %2nd
% v1=6.035;Aq1=10.1261;Bq3=8.392;eta1=0.03;Cq4=0.5166;eta2=0.0215;K1=0.1945;K2=1.6132;k1L=0.5542;k1D=0.3938;
% p1=0.8629;p1L=0.2507;d1=0.7808;Aq=0.5145;Bq=0.03258;Cq=0.82464;v2A=2.0698;K3=8.6175;K4=0.1928;K5=0.4896;k2=0.4016;
% p2=0.7848;d2D=0.369;d2L=0.2887;v3=1.0988;K6=0.4975;K7=2.3639;k3=0.5835;
% p3=0.6072;d3D=0.5029;d3L=0.5179;v4=2.5032;K8=0.3248;K9=1.7974;K10=1.2008;k4=0.9231;
% p4=1.126;de1=0.0021;de2=0.4407;de3=0.5596;de4=0.5258;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1131;K11=0.3334;k5=0.1589;p5=0.5347;d5D=0.4438;d5L=5.1006;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

%3rd
% v1=6.035;Aq1=2.21261;Bq3=0.392;eta1=0.03;Cq4=0.5166;eta2=0.0215;K1=0.1945;K2=1.6132;k1L=0.5542;k1D=0.3938;
% p1=0.8629;p1L=0.2507;d1=0.7808;Aq=1.145;Bq=0.93258;Cq=0.2464;v2A=2.0698;K3=8.6175;K4=0.1928;K5=0.4896;k2=0.4016;
% p2=0.7848;d2D=0.369;d2L=0.2887;v3=1.0988;K6=0.4975;K7=2.3639;k3=0.5835;
% p3=0.6072;d3D=0.5029;d3L=0.5179;v4=2.5032;K8=0.3248;K9=1.7974;K10=1.2008;k4=0.9231;
% p4=1.126;de1=0.0021;de2=0.4407;de3=0.5596;de4=0.5258;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1131;K11=0.3334;k5=0.1589;p5=0.5347;d5D=0.4438;d5L=5.1006;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

%4th
% v1=6.6619;Aq1=1.0261;Bq3=3.3918;eta1=0.03;Cq4=0.012178;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.5393;k1D=0.3967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=0.00145;Bq=0.583;Cq=0.12472;v2A=2.3623;K3=3.6585;K4=0.1905;K5=0.4823;k2=0.406;
% p2=0.7807;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4088;k3=0.5819;
% p3=0.6142;d3D=0.5026;d3L=0.5172;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.9251;
% p4=1.126;de1=0.0021;de2=0.4415;de3=0.5577;de4=0.577;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3323;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.7013;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

% v1=6.2618;Aq1=2.1261;Bq3=0.3918;eta1=0.03;Cq4=0.3178;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.5393;k1D=0.3967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=0.0145;Bq=1.3842;Cq=0.3472;v2A=2.0623;K3=1.6584;K4=0.1905;K5=0.4923;k2=0.4035;
% p2=0.7858;d2D=0.3712;d2L=0.2817;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819;
% p3=0.6142;d3D=0.5026;d3L=0.5172;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.77;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

% v1=6.0618;Aq1=10.261;Bq3=0.3918;eta1=0.03;Cq4=0.5178;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.5393;k1D=0.3967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=0.0145;Bq=1.3842;Cq=0.2472;v2A=2.0623;K3=8.6584;K4=0.1905;K5=0.4923;k2=0.4035;
% p2=0.7858;d2D=0.3712;d2L=0.2817;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819;
% p3=0.6142;d3D=0.5026;d3L=0.5172;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.77;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

%closer value (4/7)
% v1=4.8318;Aq1=1.2861;Bq3=8.2918;eta1=0.03;Cq4=6.0867;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.2663;k1D=0.1967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=3.0145;Bq=4.5198;Cq=9.09;v2A=1.8223;K3=2.1584;K4=0.4;K5=0.4092;k2=0.35;
% p2=0.7858;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819;
% p3=0.6142;d3D=0.5026;d3L=0.5431;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.577;de5=0.003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137;kd=7;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7162;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406;

v1=4.8318;Aq1=1.2861;Bq3=8.2918;eta1=0.03;Cq4=6.087;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.2866;k1D=0.2197;
p1=0.8672;p1L=0.2378;d1=0.7843;Aq=3.3145;Bq=4.652;Cq=9.09;v2A=1.6822;K3=2.1584;K4=0.40;K5=0.37;k2=0.35;
p2=0.7858;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819;
p3=0.6142;d3D=0.5026;d3L=0.5431;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.877;de5=0.0003;
Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137;kd=7;
v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
 K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7162;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406;



 %3/5
%  v1=4.8018;Aq1=2.0861;Bq3=0.518;eta1=0.03;Cq4=0.578;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.5663;k1D=0.3967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=0.4125;Bq=4.5983;Cq=0.8996;v2A=1.523;K3=1.1584;K4=0.235;K5=0.4923;k2=0.4035;
% p2=0.7858;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819; 
% p3=0.6142;d3D=0.5026;d3L=0.5431;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.577;de5=0.0003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;
 
% v1=4.8018;Aq1=9.861;Bq3=3.918;eta1=0.03;Cq4=0.1578;eta2=0.0215;K1=0.1943;K2=1.138;k1L=0.4663;k1D=0.23967;
% p1=0.8672;p1L=0.2378;d1=0.80843;Aq=3.21845;Bq=4.053;Cq=0.996;v2A=1.283;K3=4.5935;K4=0.35;K5=0.4923;k2=0.3535;
% p2=0.7858;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819; 
% p3=0.6142;d3D=0.5026;d3L=0.5431;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.577;de5=0.003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;
% 
% v1=5.902;Aq1=8.861;Bq3=18.918;eta1=0.03;Cq4=15.158;eta2=0.0215;K1=0.194;K2=1.238;k1L=0.4066;k1D=0.24;
% p1=0.867;p1L=0.538;d1=0.708;Aq=5.9861;%4.66218;
% Bq=11.1918;%10.583;
% Cq=20.996;v2A=1.083;K3=3.651594;K4=0.4;K5=0.392;k2=0.354;
% p2=0.786;d2D=0.371;d2L=0.292;v3=1.113;K6=0.494;K7=2.409;k3=0.582; 
% p3=0.614;d3D=0.503;d3L=0.543;v4=2.501;K8=0.326;K9=1.797;K10=1.189;k4=0.925;
% p4=1.126;de1=0.002;de2=0.42;de3=0.558;de4=0.577;de5=0.0003;
% Ap3=0.387;Am7=0.55;Ak7=1.125;Aq2=0.577;kmpac=137;kd=7;
% v5=0.113;K11=0.332;k5=0.159;p5=0.529;d5D=0.44;d5L=5.071;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.415;Bm8=0.773;Bk8=0.173;kmpbc=7162;Cp5=0.457;Cm9=0.867;Ck9=0.324;kmcc=13406;

% v1=4.9;Aq1=1.9;Bq3=10.9;eta1=0.03;Cq4=15.3;eta2=0.0215;K1=0.2;K2=1.2;k1L=0.5;k1D=0.2;
% p1=0.9;p1L=0.5;d1=0.7;Aq=3.4;Bq=1.6;Cq=21;v2A=1.6;K3=4.1;K4=0.4;K5=0.29;k2=0.3;
% p2=1.1;d2D=0.5;d2L=0.3;v3=1.1;K6=0.5;K7=2.6;k3=0.6;
% 
% p3=0.8;d3D=0.6;d3L=1;v4=1.5;K8=0.4;K9=2;K10=3;k4=0.9;
% p4=1;de1=0.004;de2=0.4;de3=0.6;de4=0.8;de5=0.0004;
% Ap3=0.4;Am7=0.5;Ak7=1.8;Aq2=0.8;kmpac=483;kd=27;
% v5=0.2;K11=0.3;k5=0.2;p5=0.6;d5D=0.5;d5L=4.4;g1=0.2;g2=3.5;
% 
% K12=0.6;Bp4=0.8;Bm8=1.1;Bk8=0.1;kmpbc=508;Cp5=0.5;Cm9=1.2;Ck9=0.5;kmcc=116839;

 

%   v1=6.5318;Aq1=1.2861;Bq3=9.2918;eta1=0.03;Cq4=0.578;eta2=0.0215;K1=0.1943;K2=1.6138;k1L=0.5663;k1D=0.3967;
% p1=0.8672;p1L=0.2378;d1=0.7843;Aq=0.0145;Bq=0.1983;Cq=0.8996;v2A=1.8223;K3=1.6584;K4=0.2305;K5=0.4923;k2=0.4035;
% p2=0.7858;d2D=0.3712;d2L=0.2917;v3=1.113;K6=0.4944;K7=2.4087;k3=0.5819;
% p3=0.6142;d3D=0.5026;d3L=0.5431;v4=2.5012;K8=0.3262;K9=1.7974;K10=1.1889;k4=0.925;
% p4=1.126;de1=0.0022;de2=0.4415;de3=0.5577;de4=0.577;de5=0.003;
% Ap3=0.3868;Am7=0.5503;Ak7=1.125;Aq2=0.5767;kmpac=137.3392;kd=6.8308;
% v5=0.1129;K11=0.3322;k5=0.1591;p5=0.5293;d5D=0.4404;d5L=5.0712;g1=0.01;g2=0.1;
%  K12=0.56;Bp4=0.4147;Bm8=0.7728;Bk8=0.1732;kmpbc=7161.8281;Cp5=0.4567;Cm9=0.867;Ck9=0.3237;kmcc=13406.1386;

if Ired ~= 0 || Iblue~= 0
    ThetaPhyA = 1;
else
    ThetaPhyA = 0;
end

if Ired ~= 0
    ThetaPhyB = 1;
else
    ThetaPhyB = 0;
end

if Iblue ~= 0
    ThetaCry = 1;
else
    ThetaCry = 0;
end

dC = zeros(18,1);

%LHY mRNA
%dC(1) = (v1 + v1L*ThetaPhyA*CombL)/(1 + (C(4)/(K1*2))^2 + (C(6)/(K2*2))^2) - (k1L*ThetaPhyA + k1D*(1-ThetaPhyA))*C(1);
dC(1) = (v1 + (Aq1*(C(9)+C(16))*ThetaPhyA+Bq3*(C(13)+C(17))*log(eta1*Ired + 1)*ThetaPhyB+Cq4*(C(14)+C(18))*log(eta2*Iblue + 1)*ThetaCry))/(1 + (C(4)/(K1))^2 + (C(6)/(K2))^2) - (k1L*ThetaPhyA + k1D*(1-ThetaPhyA))*C(1);

% LHY protein
dC(2) = (p1 + p1L*ThetaPhyA)*C(1) - d1*C(2);

% P97 mRNA
%dC(3) = (v2L*ThetaPhyA*CombL + v2A)*(1/(1 + (C(2)/(K3))^2 + (C(6)/(K4))^2 + (C(8)/(K5))^2)) - k2*C(3);
dC(3) = ((Aq*(C(9)+C(16))*ThetaPhyA+Bq*(C(13)+C(17))*log(eta1*Ired + 1)*ThetaPhyB+Cq*(C(14)+C(18))*log(eta2*Iblue + 1)*ThetaCry)+ v2A)*(1/(1 + (C(2)/(K3))^2 + (C(6)/(K4))^2 + (C(8)/(K5))^2)) - k2*C(3);

% P97 protein
dC(4) = p2*C(3) - d2D*(1-ThetaPhyA)*C(4) - d2L*ThetaPhyA*C(4);

% P51 mRNA
dC(5) = v3/(1 + (C(2)/(K6))^2 + (C(6)/(K7))^2) - k3*C(5);

% P51 protein
dC(6) = p3*C(5) - d3D*(1-ThetaPhyA)*C(6) - d3L*ThetaPhyA*C(6);

% EL mRNA
dC(7) = v4*ThetaPhyA/(1 + (C(2)/(K8))^2 + (C(6)/(K9))^2 + (C(8)/(K10))^2) - k4*C(7);
% dC(7) = v4*CombL/(1 + (C(2)/(K8))^2 + (C(6)/(K9))^2 + (C(8)/(K10))^2) - k4*C(7);

% EL protein
%dC(8) = p4*C(7) - d4D*(1-ThetaPhyA)*C(8) - d4L*ThetaPhyA*C(8);
%dC(8) = p4*C(7) - (d4D*(1-ThetaPhyA) + d4L*ThetaPhyA)*(1-1/(1+(C(15)/kac)^2+(C(16)/kacp)^2+(C(17)/kacp)^2+(C(18)/kacc)^2))*C(8);

dC(8) = p4*C(7) - (de1+(de2*C(15)+de3*C(16)+de4*C(17)+de5*C(18))/(C(15)+C(16)+C(17)+C(18)))*C(8);

% PHY A
dC(9) = (1 - ThetaPhyA)*Ap3 - (Am7*C(9)/(Ak7 + C(9))) - Aq2*ThetaPhyA*C(9)-kmpac*ThetaPhyA*C(9)*C(15)+kd*(1-ThetaPhyA)*C(16);

% PIF mRNA
dC(10) = v5/(1 + (C(8)/(K11))^2) - k5*C(10);

% PIF protein
dC(11) = p5*C(10) - d5D*(1-ThetaPhyA)*C(11) - d5L*ThetaPhyA*C(11);

% HYP protein
dC(12) = g1 + (g2*C(11)^2)/(K12^2 + C(11)^2);

% PHY B
dC(13) = Bp4 - ((Bm8*C(13))/(Bk8 + C(13)))-kmpbc*ThetaPhyB*C(13)*C(15)+kd*(1-ThetaPhyB)*C(17);

% CRY
dC(14) = Cp5 - ((Cm9*C(14))/(Ck9 + C(14)))-kmcc*ThetaCry*C(14)*C(15)+kd*(1-ThetaCry)*C(18);

%COP1
dC(15) = -kmpac*ThetaPhyA*C(9)*C(15)+kd*(1-ThetaPhyA)*C(16)-kmpbc*ThetaPhyB*C(13)*C(15)+kd*(1-ThetaPhyB)*C(17)-kmcc*ThetaCry*C(14)*C(15)+kd*(1-ThetaCry)*C(18)+ (Am7*C(16)/(Ak7 + C(16))) + Aq2*ThetaPhyA*C(16)+((Bm8*C(17))/(Bk8 + C(17)))+((Cm9*C(18))/(Ck9 + C(18)));

%COP1:PHYA
dC(16) = kmpac*ThetaPhyA*C(9)*C(15)-kd*(1-ThetaPhyA)*C(16)- (Am7*C(16)/(Ak7 + C(16)))- Aq2*ThetaPhyA*C(16);

%COP1:PHYB
dC(17) = kmpbc*ThetaPhyB*C(13)*C(15)-kd*(1-ThetaPhyB)*C(17)- ((Bm8*C(17))/(Bk8 + C(17)));

%COP1:CRY
dC(18) = kmcc*ThetaCry*C(14)*C(15)-kd*(1-ThetaCry)*C(18)- ((Cm9*C(18))/(Ck9 + C(18)));